<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=1080, height=1920, initial-scale=1.0, user-scalable=no">
<title>1080x1920 Web App</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    font-family: Arial, sans-serif;
}

/* COMMON PAGE STYLE */
.page {
    width: 100%;
    height: 100%;
    display: none;
    position: relative;
}

/* PAGE 1 */
#page1 {
    background: url("1.png") center/cover no-repeat;
}

/* DRAG AREA */
#dragArea {
    position: absolute;
    bottom: 400px;
    left: 50%;
    transform: translateX(-50%);
    width: 830px;
    height: 120px;
}

#dragBtn {
    position: absolute;
    top: 50%;
    left: 0;
    width: 160px;
    height: 100%;
    transform: translateY(-50%);
    cursor: grab;
    touch-action: none;
}

/* PAGE 2 */
#page2 {
    overflow: hidden;
}

#bgVideo {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
}

/* BUTTONS */
#buttonBox {
    position: absolute;
    bottom: 300px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    gap: 40px;
    z-index: 2;
}

.img-btn {
    width: 620px;
    height: 140px;
    opacity: 0;
    cursor: pointer;
    transition: opacity 0.8s ease;
}

/* VIDEO PAGE */
#videoPage {
    background: black;
}

#videoPlayer {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* PAGE 3 */
#page3 {
    background: url("9.png") center/cover no-repeat;
}
</style>
</head>

<body>

<!-- PAGE 1 -->
<div id="page1" class="page">
    <div id="dragArea">
        <img src="2.png" id="dragBtn">
    </div>
</div>

<!-- PAGE 2 -->
<div id="page2" class="page">
    <video id="bgVideo" loop playsinline preload="auto">
        <source src="1.mp4" type="video/mp4">
    </video>

    <div id="buttonBox">
        <img src="3.png" class="img-btn" onclick="playVideo('1.mp4')">
        <img src="4.png" class="img-btn" onclick="playVideo('E.mp4')">
        <img src="5.png" class="img-btn" onclick="playVideo('1.mp4')">
    </div>
</div>

<!-- VIDEO PAGE -->
<div id="videoPage" class="page">
   <video id="videoPlayer" playsinline></video>
</div>

<!-- PAGE 3 -->
<div id="page3" class="page"></div>

<script>
const page1 = document.getElementById("page1");
const page2 = document.getElementById("page2");
const page3 = document.getElementById("page3");
const videoPage = document.getElementById("videoPage");
const bgVideo = document.getElementById("bgVideo");
const videoPlayer = document.getElementById("videoPlayer");

page1.style.display = "block";

/* ===== DRAG LOGIC ===== */
const dragBtn = document.getElementById("dragBtn");
const dragArea = document.getElementById("dragArea");
let dragging = false;

dragBtn.addEventListener("mousedown", startDrag);
dragBtn.addEventListener("touchstart", startDrag, { passive: false });

document.addEventListener("mouseup", stopDrag);
document.addEventListener("touchend", stopDrag);

document.addEventListener("mousemove", e => moveDrag(e.clientX));
document.addEventListener("touchmove", e => moveDrag(e.touches[0].clientX), { passive: false });

function startDrag(e) {
    dragging = true;
    e.preventDefault();
}

function stopDrag() {
    dragging = false;
}

function moveDrag(x) {
    if (!dragging) return;

    const rect = dragArea.getBoundingClientRect();
    let pos = Math.max(0, Math.min(x - rect.left, rect.width));
    let percent = pos / rect.width;

    dragBtn.style.left = (percent * (rect.width - dragBtn.offsetWidth)) + "px";

    if (percent >= 0.95) {
        dragging = false;
        openPage2();
    }
}

/* ===== PAGE 2 ===== */
function openPage2() {
    page1.style.display = "none";
    page2.style.display = "block";

    bgVideo.currentTime = 0;
    bgVideo.muted = false;
    bgVideo.volume = 1;
    bgVideo.play().catch(() => {
        bgVideo.muted = true;
        bgVideo.play();
    });

    showButtons();
}

/* ===== BUTTON FADE ===== */
function showButtons() {
    document.querySelectorAll(".img-btn").forEach((btn, i) => {
        setTimeout(() => btn.style.opacity = 1, i * 800);
    });
}

/* ===== PLAY FULL VIDEO ===== */
function playVideo(src) {
    bgVideo.pause();

    page2.style.display = "none";
    videoPage.style.display = "block";

    videoPlayer.src = src;
    videoPlayer.currentTime = 0;
    videoPlayer.muted = false;
    videoPlayer.volume = 1;
    videoPlayer.play();
}

/* ===== RETURN TO FIRST PAGE AFTER VIDEO ENDS ===== */
videoPlayer.onended = () => {
    videoPage.style.display = "none";
    page1.style.display = "block";

    // Reset all videos to first frame
    bgVideo.currentTime = 0;
    bgVideo.play().catch(() => bgVideo.muted = true);

    // Reset drag button
    dragBtn.style.left = "0px";
    document.querySelectorAll(".img-btn").forEach(btn => btn.style.opacity = 0);
};
</script>

</body>
</html>
